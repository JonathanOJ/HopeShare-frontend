<header class="header">
  <section class="container">
    <button
      pButton
      icon="pi pi-bars"
      class="md:hidden p-button-text p-button-rounded"
      (click)="toggleSidebar()"
      aria-label="Menu"
    ></button>

    <img
      (click)="redirectTo('hopeshare/home')"
      class="hidden md:flex w-[190px] cursor-pointer"
      src="./../../../assets/images/logo-marca.png"
      alt="Logo HopeShare"
    />
    <img
      (click)="redirectTo('hopeshare/home')"
      class="md:hidden cursor-pointer w-[40px]"
      src="./../../../assets/images/icone.png"
      alt="Logo HopeShare"
    />
    <p-tabView class="h-[60px] hidden md:flex" [(activeIndex)]="activeIndex" (click)="tabChange()">
      <p-tabPanel header="Home"> </p-tabPanel>
      <!-- Se o usuário for do tipo EMPRESA ou Admin -->
      @if (userSession?.type_user === 1 || userSession?.admin) {
        <p-tabPanel header="Meus posts"> </p-tabPanel>
        <p-tabPanel header="Dashboard"> </p-tabPanel>
        <p-tabPanel header="Relatórios"> </p-tabPanel>
        <p-tabPanel header="Configurações"> </p-tabPanel>
      }
      @if (userSession?.admin) {
        <p-tabPanel header="Painel Admin"> </p-tabPanel>
      }
    </p-tabView>

    <section class="flex items-center gap-2 cursor-pointer">
      <p-button size="small" [text]="true" icon="pi pi-palette" (click)="toggleTheme()" />
      @if (!userSession) {
        <p-button
          size="small"
          [rounded]="true"
          [outlined]="true"
          label="Registre-se grátis"
          (click)="redirectTo('login/register')"
        />
        <p-button size="small" [rounded]="true" label="Login" (click)="redirectTo('login')" />
      } @else {
        @if (userSession.image) {
          <img
            (click)="menu.toggle($event)"
            class="hidden md:block w-10 h-10 cursor-pointer"
            [src]="userSession.image"
            alt="User profile image of {{ userSession.username }}"
          />
          <img
            (click)="toggleSidebar()"
            class="md:hidden w-10 h-10 cursor-pointer"
            [src]="userSession.image"
            alt="User profile image of {{ userSession.username }}"
          />
        } @else {
          <span
            (click)="menu.toggle($event)"
            class="hidden md:flex w-10 h-10 justify-center items-center rounded-full cursor-pointer"
            style="background-color: var(--primary-color); color: var(--primary-color-text)"
            >{{ userSession ? userSession.username[0].toUpperCase() : 'U' }}</span
          >
          <span
            (click)="toggleSidebar()"
            class="md:hidden w-10 h-10 flex justify-center items-center rounded-full cursor-pointer"
            style="background-color: var(--primary-color); color: var(--primary-color-text)"
            >{{ userSession ? userSession.username[0].toUpperCase() : 'U' }}</span
          >
        }

        <p-menu #menu [model]="settings" appendTo="body" [popup]="true" />
      }
    </section>
  </section>
</header>

<p-sidebar [(visible)]="sidebarVisible" position="left" [style]="{ width: '280px' }" [showCloseIcon]="true">
  <ng-template pTemplate="header">
    <div class="flex items-center gap-3">
      <img src="./../../../assets/images/logo-marca.png" class="w-[140px]" alt="Logo HopeShare" />
    </div>
  </ng-template>

  <div class="flex flex-col gap-2">
    <!-- Menu de navegação -->
    @for (item of menuItems; track item.label) {
      <button
        pButton
        [label]="item.label || ''"
        [icon]="item.icon || ''"
        class="p-button-text justify-start"
        (click)="executeMenuCommand(item)"
      ></button>
    }

    <!-- Separador -->
    @if (userSession) {
      <p-divider></p-divider>

      <!-- Informações do usuário -->
      <div class="flex items-center gap-3 px-3 py-2">
        @if (userSession.image) {
          <img
            class="w-10 h-10 rounded-full"
            [src]="userSession.image"
            alt="User profile image of {{ userSession.username }}"
          />
        } @else {
          <span
            class="w-10 h-10 flex justify-center items-center rounded-full"
            style="background-color: var(--primary-color); color: var(--primary-color-text)"
            >{{ userSession.username[0].toUpperCase() }}</span
          >
        }
        <div class="flex-1 min-w-0">
          <p class="font-semibold text-primary truncate">{{ userSession.username }}</p>
          <p class="text-xs text-secondary truncate">{{ userSession.email }}</p>
        </div>
      </div>

      <!-- Opções do usuário -->
      <button
        pButton
        label="Histórico"
        icon="pi pi-history"
        class="p-button-text justify-start"
        (click)="redirectTo('hopeshare/configuracao/historico'); sidebarVisible = false"
      ></button>

      <button
        pButton
        label="Suporte"
        icon="pi pi-envelope"
        class="p-button-text justify-start"
        (click)="supportDialogService.open(); sidebarVisible = false"
      ></button>

      <button
        pButton
        label="Logout"
        icon="pi pi-sign-out"
        class="p-button-text justify-start"
        severity="danger"
        (click)="logout(); sidebarVisible = false"
      ></button>
    }
  </div>
</p-sidebar>

