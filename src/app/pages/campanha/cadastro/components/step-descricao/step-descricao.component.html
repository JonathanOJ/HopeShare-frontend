<ng-template #header pTemplate="header" let-onClick="onClick" let-index="index">
  <section class="flex gap-3">
    <div
      class="w-[48px] h-[48px] flex items-center justify-center rounded-full"
      [ngClass]="{
        'text-white': activeStep === index,
        'text-[#D1D1D1]': activeStep !== index,
        'bg-[#3b82f6]': activeStep === index,
        'bg-[#F6F6F6]': activeStep !== index,
      }"
    >
      <mat-icon svgIcon="pencil-outline"></mat-icon>
    </div>
    @if (activeStep === index) {
      <div class="flex flex-col justify-center">
        <span class="text-xs text-[#3b82f6] font-bold"> Passo {{ index + 1 }}/{{ totalSteps }} </span>
        <span class="text-[#454545]">Conhecendo o campanha</span>
      </div>
    }
  </section>
</ng-template>
<ng-template
  #content
  pTemplate="content"
  let-prevCallback="prevCallback"
  let-nextCallback="nextCallback"
  let-index="index"
>
  <form *ngIf="stepDescricaoForm" [formGroup]="stepDescricaoForm" class="flex flex-col h-[700px] p-6 gap-6">
    <div class="flex flex-col gap-2">
      <h1 class="text-xl text-[#3d3d3d] font-bold">Fale um pouco mais</h1>
      <span class="text-[#4F4F4F] max-w-[400px]"
        >Escreva mais detalhes sobre seu campanha, não economize nas palavras.</span
      >
    </div>
    <section class="h-[482px] gap-6 flex flex-col">
      <section class="flex gap-2 justify-between">
        <div class="flex flex-col gap-1.5 w-[88%]">
          <label for="title" class="text-sm text-[#4F4F4F]">Titulo do campanha</label>
          <input
            type="text"
            pInputText
            formControlName="title"
            (blur)="title?.invalid && title?.markAsDirty()"
            placeholder="Seu titulo aqui"
          />

          <div
            class="flex align-items-end text-xs"
            [ngClass]="title?.invalid && (title?.dirty || title?.touched) ? 'justify-between' : 'justify-end'"
          >
            <span
              [ngClass]="
                title?.invalid && (title?.dirty || title?.touched)
                  ? 'visible text-[#ff2637]'
                  : 'invisible text-[#ff2637]'
              "
            >
              <ng-container *ngIf="title?.errors as errors">
                <ng-container *ngIf="errors['required']">Campo obrigatório!</ng-container>
                <ng-container *ngIf="errors['minlength']">Mínimo de 3 caracteres.</ng-container>
                <ng-container *ngIf="errors['maxlength']">Máximo de 100 caracteres.</ng-container>
              </ng-container>
            </span>
            {{ title?.value?.length || 0 }}/100
          </div>
        </div>
        <div class="flex gap-2 items-center pt-[10px]">
          <p-toggleButton
            class="mb-[6px] w-[120px]"
            formControlName="request_emergency"
            onLabel="Urgente"
            offLabel="Não urgente"
          ></p-toggleButton>
          <p-toggleButton
            class="mb-[6px] w-[160px]"
            formControlName="have_address"
            [onLabel]="'Contém endereço'"
            [offLabel]="'Sem endereço'"
            (onChange)="handleHaveAddressChange()"
          ></p-toggleButton>
        </div>
      </section>
      <div class="flex flex-col gap-3 items-center justify-center py-4 rounded-lg border border-[#D1D1D1 ]">
        <p-fileUpload
          mode="basic"
          chooseLabel="Escolha"
          chooseIcon="pi pi-upload"
          name="demo[]"
          url="https://www.primefaces.org/cdn/api/upload.php"
          accept="image/*"
          maxFileSize="1000000"
          (onUpload)="onUpload($event)"
        />
        <div class="flex flex-col gap-1 text-center">
          <span class="text-sm text-[#5D5D5D]"
            ><strong class="text-[#3b82f6] font-semibold">Selecione</strong> uma foto para representar seu
            campanha</span
          >
          <span class="text-sm text-[#5D5D5D]">PNG ou JPG</span>
        </div>
      </div>
      <div class="flex flex-col gap-1.5">
        <label for="description" class="text-sm text-[#4F4F4F]">Descrição</label>
        <textarea
          rows="5"
          cols="30"
          pInputTextarea
          placeholder="Escreva a descrição do seu campanha, não economize nas palavras"
          formControlName="description"
          (blur)="description?.invalid && description?.markAsDirty()"
        ></textarea>

        <div
          class="flex align-items-end text-xs"
          [ngClass]="
            description?.invalid && (description?.dirty || description?.touched) ? 'justify-between' : 'justify-end'
          "
        >
          <span
            [ngClass]="
              description?.invalid && (description?.dirty || description?.touched)
                ? 'visible text-[#ff2637]'
                : 'invisible text-[#ff2637]'
            "
          >
            <ng-container *ngIf="description?.errors as errors">
              <ng-container *ngIf="errors['required']">Campo obrigatório!</ng-container>
              <ng-container *ngIf="errors['minlength']">Mínimo de 10 caracteres.</ng-container>
              <ng-container *ngIf="errors['maxlength']">Máximo de 500 caracteres.</ng-container>
            </ng-container>
          </span>
          {{ description?.value?.length || 0 }}/500
        </div>
      </div>
    </section>
    <section class="flex justify-between">
      <p-button label="Cancelar" severity="danger" iconPos="right" (onClick)="onCancel.emit()" />
      <div class="flex justify-end gap-2">
        <p-button label="Voltar" [outlined]="true" (onClick)="prevCallback.emit()" />
        <p-button
          [disabled]="stepDescricaoForm.invalid"
          label="Continuar"
          iconPos="right"
          (onClick)="nextCallback.emit()"
        />
      </div>
    </section>
  </form>
</ng-template>

