<ng-template #header pTemplate="header" let-onClick="onClick" let-index="index">
  <section class="flex gap-3">
    <div
      class="w-[48px] h-[48px] flex items-center justify-center rounded-full"
      [ngClass]="{
        'text-white': activeStep === index,
        'text-[#D1D1D1]': activeStep !== index,
        'bg-[#3b82f6]': activeStep === index,
        'bg-[#F6F6F6]': activeStep !== index,
      }"
    >
      <mat-icon svgIcon="database-outline"></mat-icon>
    </div>
    @if (activeStep === index) {
      <div class="flex flex-col justify-center">
        <span class="text-xs text-[#3b82f6] font-bold"> Passo {{ index + 1 }}/{{ totalSteps }} </span>
        <span class="text-[#454545]">Metas do campanha</span>
      </div>
    }
  </section>
</ng-template>
<ng-template
  #content
  pTemplate="content"
  let-prevCallback="prevCallback"
  let-nextCallback="nextCallback"
  let-index="index"
>
  <form *ngIf="stepMetaForm" [formGroup]="stepMetaForm" class="flex flex-col h-fit p-6 gap-6 pb-0">
    <div class="flex flex-col gap-2">
      <h1 class="text-xl text-[#3d3d3d] font-bold">Quanto você precisa?</h1>
      <span class="text-[#4F4F4F] max-w-[400px]">Defina a meta que você quer alcançar com seu campanha</span>
    </div>
    <section class="h-fit">
      <section class="flex gap-4 flex-wrap items-center justify-center">
        @for (option of optionsValues; track option; let index = $index) {
          <div
            [ngClass]="{
              'border-2': option.selected,
              border: !option.selected,
              'border-[#E7E7E7]': !option.selected,
              'border-[#3b82f6]': option.selected,
            }"
            class="rounded-xl w-[200px] h-[125px] items-center justify-center flex flex-col gap-2 cursor-pointer hover:bg-[#F6F6F6]"
            (click)="handleValueSelected(option)"
          >
            <mat-icon
              style="width: 42px; height: 42px"
              [style.color]="option.selected ? '#3b82f6' : '#3d3d3d'"
              [svgIcon]="option.icon"
            ></mat-icon>

            <span
              [class]="option.selected ? 'text-[#3b82f6]' : 'text-[#3d3d3d]'"
              class="font-semibold text-[#4F4F4F] text-sm"
            >
              {{ option.value | formatValueBrl }}
            </span>
          </div>
          @if (index === 2 || index === 4) {
            <div class="w-full"></div>
          }
        }
      </section>

      @if (isCustomValueSelected) {
        <div class="mt-6 flex flex-col gap-3 items-center">
          <label for="custom_value" class="text-sm text-[#4F4F4F] font-medium">Digite o valor desejado:</label>
          <div class="flex flex-col gap-2">
            <p-inputNumber
              id="custom_value"
              formControlName="custom_value"
              mode="currency"
              currency="BRL"
              locale="pt-BR"
              [min]="1"
              [max]="999999999"
              placeholder="R$ 0,00"
              (onInput)="handleCustomValueChange(+($event.value || 0))"
              styleClass="w-[300px]"
            ></p-inputNumber>

            <div class="flex align-items-end text-xs justify-end">
              <span
                [ngClass]="
                  custom_value?.invalid && (custom_value?.dirty || custom_value?.touched)
                    ? 'visible text-[#ff2637]'
                    : 'invisible text-[#ff2637]'
                "
              >
                <ng-container *ngIf="custom_value?.errors as errors">
                  <ng-container *ngIf="errors['required']">Campo obrigatório!</ng-container>
                  <ng-container *ngIf="errors['min']">Valor deve ser maior que R$ 0,00.</ng-container>
                </ng-container>
              </span>
            </div>
          </div>
        </div>
      }
    </section>
    <section class="flex justify-between">
      <p-button label="Cancelar" severity="danger" iconPos="right" (onClick)="onCancel.emit()" />
      <div class="flex justify-end gap-2">
        <p-button label="Voltar" [outlined]="true" (onClick)="prevCallback.emit()" />
        <p-button [disabled]="isFormInvalid()" label="Continuar" iconPos="right" (onClick)="nextCallback.emit()" />
      </div>
    </section>
  </form>
</ng-template>

