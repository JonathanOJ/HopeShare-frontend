<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  header="Denunciar Campanha"
  styleClass="w-full max-w-2xl"
  (onHide)="closeModal()"
>
  <div class="flex flex-col gap-4">
    <div class="bg-gray-50 p-3 rounded-lg">
      <h4 class="font-medium text-sm text-gray-700 mb-1">Campanha:</h4>
      <p class="text-sm text-gray-600 truncate">{{ campanha?.title }}</p>
    </div>

    <form [formGroup]="reportForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
      <div class="flex flex-col gap-2">
        <label for="reason-dropdown" class="text-sm font-medium text-gray-700">Motivo da Denúncia *</label>
        <p-dropdown
          id="reason-dropdown"
          formControlName="reason"
          [options]="reasons"
          optionLabel="label"
          optionValue="value"
          placeholder="Selecione um motivo"
          styleClass="w-full"
          [showClear]="true"
        ></p-dropdown>
        <small class="text-red-500" *ngIf="getFieldError('reason')">
          {{ getFieldError('reason') }}
        </small>
      </div>

      <div class="flex flex-col gap-2">
        <label for="description-textarea" class="text-sm font-medium text-gray-700">Descrição Detalhada *</label>
        <textarea
          id="description-textarea"
          formControlName="description"
          pInputTextarea
          rows="4"
          placeholder="Descreva em detalhes o motivo da sua denúncia..."
          class="w-full"
        ></textarea>
        <div class="flex justify-between">
          <small class="text-red-500" *ngIf="getFieldError('description')">
            {{ getFieldError('description') }}
          </small>
          <small class="text-gray-500"> {{ reportForm.get('description')?.value?.length || 0 }}/500 </small>
        </div>
      </div>

      <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3">
        <div class="flex">
          <mat-icon class="text-yellow-400 mr-2" svgIcon="alert"></mat-icon>
          <div>
            <p class="text-sm text-yellow-700">
              <strong>Atenção:</strong> Denúncias falsas podem resultar em punições.
            </p>
          </div>
        </div>
      </div>

      <div class="flex justify-end gap-3 mt-4">
        <p-button
          type="button"
          label="Cancelar"
          severity="secondary"
          [text]="true"
          (onClick)="closeModal()"
          [disabled]="loading"
        ></p-button>

        <p-button
          type="submit"
          label="Enviar Denúncia"
          severity="danger"
          [loading]="loading"
          [disabled]="reportForm.invalid"
          icon="pi pi-flag"
        ></p-button>
      </div>
    </form>
  </div>
</p-dialog>

